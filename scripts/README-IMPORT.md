# Импорт товаров из Google Sheets

## Быстрый старт

### Вариант 1: Автоматический (рекомендуется)

```bash
npm run import:products
```

Скрипт автоматически:
1. Скачает таблицу из Google Sheets как CSV
2. Распарсит все товары
3. Скачает все изображения в `public/images/products/`
4. Создаст файл `lib/imported-products.ts` с готовыми данными

### Вариант 2: Ручной (если автоматический не работает)

1. **Скачайте таблицу:**
   - Откройте: https://docs.google.com/spreadsheets/d/1uBg2NMNzF4GzNPSVzVO7N4vnllDfCihapIzsJwntDrE/edit
   - File → Download → Comma Separated Values (.csv)
   - Сохраните как `scripts/products.csv`

2. **Запустите импорт:**
   ```bash
   npm run import:products
   ```

## Формат таблицы

Скрипт автоматически распознаёт колонки по заголовкам (регистр не важен):

### Основные поля:
- **Артикул** (обязательно) - `артикул`, `sku`, `код`
- **Название** (обязательно) - `название`, `name`, `наименование`
- **Коллекция** - `коллекция`, `collection`
- **Формат** - `формат`, `format`, `размер`
- **Тип товара** - `тип товара`, `product_type`, `тип`
- **Цена** - `цена`, `price`, `цена розница`
- **Фото** - `фото`, `image`, `изображение`

### Дополнительные поля:
- `поверхность`, `surface`
- `цвет`, `color`
- `остаток янино`, `stock_yanino`
- `остаток завод`, `stock_factory`
- `цена официальная`, `price_official`
- `бренд`, `brand`
- `страна`, `country`
- `описание`, `description`

## Результат импорта

После импорта создаётся файл `lib/imported-products.ts`:

```typescript
import { Product } from './mock-data'

export const importedProducts: Product[] = [
  {
    id: 1,
    sku: "KT2L051",
    name: "Calacatta узор белый 29.8x59.8",
    collection: "Calacatta",
    // ... остальные поля
  },
  // ... все товары
]
```

## Использование импортированных данных

### Замена существующих товаров:

```typescript
// lib/mock-data.ts
import { importedProducts } from './imported-products'

export const products = importedProducts
```

### Объединение с существующими:

```typescript
// lib/mock-data.ts
import { importedProducts } from './imported-products'

export const products = [
  ...importedProducts,
  // ... ваши дополнительные товары
]
```

## Изображения

Все изображения скачиваются в папку:
```
public/images/products/
  ├── KT2L051.jpg
  ├── A17697.jpg
  └── ...
```

Пути в товарах автоматически устанавливаются как:
```typescript
{
  images: ["/images/products/KT2L051.jpg"],
  main_image: "/images/products/KT2L051.jpg"
}
```

## Особенности

1. **Автоматическая генерация slug** из названия + артикула
2. **Определение типа материала** (керамогранит/керамика) по названию
3. **Автоопределение скидки** при наличии официальной цены
4. **Пропуск уже скачанных изображений** - можно запускать повторно
5. **Задержка между загрузками** - защита от перегрузки сервера

## Устранение проблем

### Ошибка "CSV файл пуст"
- Проверьте, что таблица экспортирована корректно
- Убедитесь, что файл `scripts/products.csv` не пустой

### Ошибка загрузки изображений
- Проверьте доступность URL изображений
- Проверьте права на запись в папку `public/images/products/`
- Изображения с ошибками будут пропущены, импорт продолжится

### Не скачивается таблица автоматически
- Убедитесь, что таблица имеет публичный доступ (хотя бы "просмотр по ссылке")
- Используйте ручной вариант (скачайте CSV вручную)

## Расширение скрипта

Скрипт находится в `scripts/import-products-from-sheets.mjs` и легко модифицируется:

- Добавьте новые маппинги полей в функции `normalizeProduct()`
- Измените логику генерации slug
- Добавьте валидацию данных
- Настройте обработку изображений
